{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: {{ ref('activities_ab1') }}
select
    cast(last_notification_time as {{ dbt_utils.type_string() }}) as last_notification_time,
    cast(location_street_number as {{ dbt_utils.type_string() }}) as location_street_number,
    cast(type_name as {{ dbt_utils.type_string() }}) as type_name,
    cast(reference_id as {{ dbt_utils.type_bigint() }}) as reference_id,
    cast(location_route as {{ dbt_utils.type_string() }}) as location_route,
    cast(public_description as {{ dbt_utils.type_string() }}) as public_description,
    cast(notification_language_id as {{ dbt_utils.type_bigint() }}) as notification_language_id,
    cast(subject as {{ dbt_utils.type_string() }}) as subject,
    cast({{ adapter.quote('type') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('type') }},
    cast(google_calendar_etag as {{ dbt_utils.type_string() }}) as google_calendar_etag,
    cast(google_calendar_id as {{ dbt_utils.type_string() }}) as google_calendar_id,
    cast(deal_title as {{ dbt_utils.type_string() }}) as deal_title,
    cast({{ adapter.quote('id') }} as {{ dbt_utils.type_bigint() }}) as {{ adapter.quote('id') }},
    cast(deal_id as {{ dbt_utils.type_bigint() }}) as deal_id,
    cast(location_lat as {{ dbt_utils.type_float() }}) as location_lat,
    cast(gcal_event_id as {{ dbt_utils.type_string() }}) as gcal_event_id,
    {{ cast_to_boolean('busy_flag') }} as busy_flag,
    cast(person_id as {{ dbt_utils.type_bigint() }}) as person_id,
    cast(location_long as {{ dbt_utils.type_float() }}) as location_long,
    cast(owner_name as {{ dbt_utils.type_string() }}) as owner_name,
    attendees,
    cast(person_name as {{ dbt_utils.type_string() }}) as person_name,
    cast(rec_rule_extension as {{ dbt_utils.type_string() }}) as rec_rule_extension,
    {{ cast_to_boolean('done') }} as done,
    cast(created_by_user_id as {{ dbt_utils.type_bigint() }}) as created_by_user_id,
    cast(location_sublocality as {{ dbt_utils.type_string() }}) as location_sublocality,
    cast(rec_rule as {{ dbt_utils.type_string() }}) as rec_rule,
    cast(location_admin_area_level_2 as {{ dbt_utils.type_string() }}) as location_admin_area_level_2,
    cast(user_id as {{ dbt_utils.type_bigint() }}) as user_id,
    cast(location_admin_area_level_1 as {{ dbt_utils.type_string() }}) as location_admin_area_level_1,
    cast(org_id as {{ dbt_utils.type_bigint() }}) as org_id,
    cast(conference_meeting_client as {{ dbt_utils.type_string() }}) as conference_meeting_client,
    cast(note as {{ dbt_utils.type_string() }}) as note,
    cast(due_time as {{ dbt_utils.type_string() }}) as due_time,
    cast(rec_master_activity_id as {{ dbt_utils.type_bigint() }}) as rec_master_activity_id,
    cast(location_country as {{ dbt_utils.type_string() }}) as location_country,
    {{ cast_to_boolean('active_flag') }} as active_flag,
    cast(duration as {{ dbt_utils.type_string() }}) as duration,
    cast(location_postal_code as {{ dbt_utils.type_string() }}) as location_postal_code,
    cast({{ empty_string_to_null('update_time') }} as {{ type_timestamp_without_timezone() }}) as update_time,
    cast({{ adapter.quote('file') }} as {{ type_json() }}) as {{ adapter.quote('file') }},
    cast(update_user_id as {{ dbt_utils.type_bigint() }}) as update_user_id,
    cast(source_timezone as {{ dbt_utils.type_string() }}) as source_timezone,
    cast(person_dropbox_bcc as {{ dbt_utils.type_string() }}) as person_dropbox_bcc,
    cast(conference_meeting_id as {{ dbt_utils.type_string() }}) as conference_meeting_id,
    cast(org_name as {{ dbt_utils.type_string() }}) as org_name,
    cast(location_locality as {{ dbt_utils.type_string() }}) as location_locality,
    cast(assigned_to_user_id as {{ dbt_utils.type_bigint() }}) as assigned_to_user_id,
    cast(lead_id as {{ dbt_utils.type_string() }}) as lead_id,
    participants,
    cast(location_subpremise as {{ dbt_utils.type_string() }}) as location_subpremise,
    cast(company_id as {{ dbt_utils.type_bigint() }}) as company_id,
    cast(due_date as {{ dbt_utils.type_string() }}) as due_date,
    cast(reference_type as {{ dbt_utils.type_string() }}) as reference_type,
    cast(last_notification_user_id as {{ dbt_utils.type_bigint() }}) as last_notification_user_id,
    {{ cast_to_boolean('calendar_sync_include_context') }} as calendar_sync_include_context,
    cast(marked_as_done_time as {{ dbt_utils.type_string() }}) as marked_as_done_time,
    cast(location_formatted_address as {{ dbt_utils.type_string() }}) as location_formatted_address,
    cast(series as {{ dbt_utils.type_string() }}) as series,
    cast(conference_meeting_url as {{ dbt_utils.type_string() }}) as conference_meeting_url,
    cast({{ adapter.quote('location') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('location') }},
    cast(deal_dropbox_bcc as {{ dbt_utils.type_string() }}) as deal_dropbox_bcc,
    cast(add_time as {{ dbt_utils.type_string() }}) as add_time,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ ref('activities_ab1') }}
-- activities
where 1 = 1

