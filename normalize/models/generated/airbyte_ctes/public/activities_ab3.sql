{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ ref('activities_ab2') }}
select
    {{ dbt_utils.surrogate_key([
        'last_notification_time',
        'location_street_number',
        'type_name',
        'reference_id',
        'location_route',
        'public_description',
        'notification_language_id',
        'subject',
        adapter.quote('type'),
        'google_calendar_etag',
        'google_calendar_id',
        'deal_title',
        adapter.quote('id'),
        'deal_id',
        'location_lat',
        'gcal_event_id',
        boolean_to_string('busy_flag'),
        'person_id',
        'location_long',
        'owner_name',
        array_to_string('attendees'),
        'person_name',
        'rec_rule_extension',
        boolean_to_string('done'),
        'created_by_user_id',
        'location_sublocality',
        'rec_rule',
        'location_admin_area_level_2',
        'user_id',
        'location_admin_area_level_1',
        'org_id',
        'conference_meeting_client',
        'note',
        'due_time',
        'rec_master_activity_id',
        'location_country',
        boolean_to_string('active_flag'),
        'duration',
        'location_postal_code',
        'update_time',
        object_to_string(adapter.quote('file')),
        'update_user_id',
        'source_timezone',
        'person_dropbox_bcc',
        'conference_meeting_id',
        'org_name',
        'location_locality',
        'assigned_to_user_id',
        'lead_id',
        array_to_string('participants'),
        'location_subpremise',
        'company_id',
        'due_date',
        'reference_type',
        'last_notification_user_id',
        boolean_to_string('calendar_sync_include_context'),
        'marked_as_done_time',
        'location_formatted_address',
        'series',
        'conference_meeting_url',
        adapter.quote('location'),
        'deal_dropbox_bcc',
        'add_time',
    ]) }} as _airbyte_activities_hashid,
    tmp.*
from {{ ref('activities_ab2') }} tmp
-- activities
where 1 = 1

